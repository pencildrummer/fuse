"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[22],{8022:function(e,t,n){n.r(t),n.d(t,{default:function(){return m}});var r=n(5893),_=n(7294),s=n(1605),i=n(6724),a=n(7194),E=n(8844),l=Object.freeze({STEP_PULSE:0,STEP_DELAY:1,STEP_PORT_INVERT:2,DIRECTION_PORT_INVERT:3,STEP_ENABLE_INVERT:4,LIMIT_PINS_INVERT:5,PROBE_PIN_INVERT:6,STATUS_REPORT:10,JUNCTION_DEVIATION:11,ARC_TOLERANCE:12,REPORT_INCHES:13,SOFT_LIMITS:20,HARD_LIMITS:21,HOMING_CYCLE:22,HOMING_DIR_INVERT:23,HOMING_FEED:24,HOMING_SEEK:25,HOMING_DEBOUNCE:26,HOMING_PULL_OFF:27,MAX_SPINDLE_SPEED:30,MIN_SPINDLE_SPEED:31,LASER_MODE:32,X_STEPS_ON_MM:100,Y_STEPS_ON_MM:101,Z_STEPS_ON_MM:102,X_MAX_RATE:110,Y_MAX_RATE:111,Z_MAX_RATE:112,X_ACCELERATION:120,Y_ACCELERATION:121,Z_ACCELERATION:122,X_MAX_TRAVEL:130,Y_MAX_TRAVEL:131,Z_MAX_TRAVEL:132}),c=Object.freeze({STEP_PULSE:"grbl.setting.step_pulse",STEP_DELAY:"grbl.setting.step_delay",STEP_PORT_INVERT:"grbl.setting.step_port_invert",DIRECTION_PORT_INVERT:"grbl.setting.direction_port_invert",STEP_ENABLE_INVERT:"grbl.setting.step_enable_invert",LIMIT_PINS_INVERT:"grbl.setting.limit_pins_invert",PROBE_PIN_INVERT:"grbl.setting.probe_pin_invert",STATUS_REPORT:"grbl.setting.status_report",JUNCTION_DEVIATION:"grbl.setting.junction_deviation",ARC_TOLERANCE:"grbl.setting.arc_tolerance",REPORT_INCHES:"grbl.setting.report_inches",SOFT_LIMITS:"grbl.setting.soft_limits",HARD_LIMITS:"grbl.setting.hard_limits",HOMING_CYCLE:"grbl.setting.homing_cycle",HOMING_DIR_INVERT:"grbl.setting.homing_dir_invert",HOMING_FEED:"grbl.setting.homing_feed",HOMING_SEEK:"grbl.setting.homing_seek",HOMING_DEBOUNCE:"grbl.setting.homing_debounce",HOMING_PULL_OFF:"grbl.setting.homing_pull_off",MAX_SPINDLE_SPEED:"grbl.setting.max_spindle_speed",MIN_SPINDLE_SPEED:"grbl.setting.min_spindle_speed",LASER_MODE:"grbl.setting.laser_mode",X_STEPS_ON_MM:"grbl.setting.x_steps_on_mm",Y_STEPS_ON_MM:"grbl.setting.y_steps_on_mm",Z_STEPS_ON_MM:"grbl.setting.z_steps_on_mm",X_MAX_RATE:"grbl.setting.x_max_rate",Y_MAX_RATE:"grbl.setting.y_max_rate",Z_MAX_RATE:"grbl.setting.z_max_rate",X_ACCELERATION:"grbl.setting.x_acceleration",Y_ACCELERATION:"grbl.setting.y_acceleration",Z_ACCELERATION:"grbl.setting.z_acceleration",X_MAX_TRAVEL:"grbl.setting.x_max_travel",Y_MAX_TRAVEL:"grbl.setting.y_max_travel",Z_MAX_TRAVEL:"grbl.setting.z_max_travel"});function u(e){switch(parseInt(e)){case l.STEP_ENABLE_INVERT:case l.LIMIT_PINS_INVERT:case l.PROBE_PIN_INVERT:case l.REPORT_INCHES:case l.SOFT_LIMITS:case l.HARD_LIMITS:case l.HOMING_CYCLE:case l.LASER_MODE:return Boolean;default:return Number}}function o(e){switch(parseInt(e)){case l.STEP_PULSE:return"\u03bcs";case l.STEP_DELAY:return"ms";case l.JUNCTION_DEVIATION:case l.ARC_TOLERANCE:return"mm";case l.HOMING_FEED:case l.HOMING_SEEK:return"mm/min";case l.HOMING_DEBOUNCE:return"ms";case l.HOMING_PULL_OFF:return"mm";case l.MAX_SPINDLE_SPEED:case l.MIN_SPINDLE_SPEED:return"RPM";case l.X_STEPS_ON_MM:case l.Y_STEPS_ON_MM:case l.Z_STEPS_ON_MM:return"steps/mm";case l.X_MAX_RATE:case l.Y_MAX_RATE:case l.Z_MAX_RATE:return"mm/min";case l.X_ACCELERATION:case l.Y_ACCELERATION:case l.Z_ACCELERATION:return"mm/s^2";case l.X_MAX_TRAVEL:case l.Y_MAX_TRAVEL:case l.Z_MAX_TRAVEL:return"mm";default:return null}}function g(e,t){if(null==e)return{};var n,r,_=function(e,t){if(null==e)return{};var n,r,_={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(_[n]=e[n]);return _}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(_[n]=e[n])}return _}function N(e){var t=e.fieldKey,n=e.disabled,_=(g(e,["fieldKey","disabled"]),(0,E.Z)().formatMessage),s=u(l[t]);return(0,r.jsxs)(i.ZA,{children:[(0,r.jsxs)(i.__,{htmlFor:t,className:"truncate flex flex-row space-x-1 items-center",children:[(0,r.jsxs)("div",{className:"flex-none w-8 text-xs text-gray-600 text-right",children:["$",l[t]]}),(0,r.jsx)("div",{className:"text-sm truncate",children:_({id:c[t],defaultMessage:c[t]})})]}),s==Boolean&&(0,r.jsx)(i.rs,{id:t,name:t,disabled:n}),s==Number&&(0,r.jsx)(i.II,{type:"number",id:t,name:t,disabled:n,className:"w-36",detailContent:o(l[t])})]},"setting-".concat(c[t]))}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){I(e,t,n[t])}))}return e}function O(e,t){return u(e)===Boolean?Boolean(parseInt(t)):t}function m(){var e=function(e){if(console.log("New message",e),"device"==e.from){var t=function(e){var t=e.match(/\$(?<settingId>[0-9]*)=(?<settingValue>.*)/);return t?{id:t.groups.settingId,value:O(t.groups.settingId,t.groups.settingValue)}:null}(e.message);t&&c((function(e){return T({},e,I({},GRBLSetting[Number(t.id)],T({},e[GRBLSetting[Number(t.id)]],{value:t.value,disabled:!1})))}))}},t=(0,s.v$)().device,n=(0,_.useState)(function(){var e={};for(var t in l)isNaN(Number(t))&&(e[t]=T({},e[t],{value:"",disabled:!0}));return e}()),E=n[0],c=n[1],o=(0,_.useMemo)((function(e){return Object.keys(E).reduce((function(e,t){return T({},e,I({},t,E[t].value))}),{})}),[E]);return(0,_.useEffect)((function(n){return t.terminal.connect((function(e){console.log("Connected",e)})),t.terminal.sendMessage("$$"),t.terminal.onMessageReceived(e),function(n){return t.terminal.offMessageReceived(e)}}),[t.terminal]),(0,r.jsx)(i.$L,{title:"GRBL settings",children:(0,r.jsx)(a.v6,{terminal:t.terminal,children:t.terminal?(0,r.jsxs)(i.l0,{initialValues:o,enableReinitialize:!0,onSubmit:function(e,n){var r=Object.keys(e).reduce((function(t,n){return e[n]!=o[n]?T({},t,I({},n,e[n])):t}),{});console.log("Submit values",r),c((function(e){return Object.keys(r).reduce((function(e,t){var n=e[t];return n?T({},e,I({},t,T({},n,{disabled:!0}))):e}),e)})),Object.keys(r).forEach((function(e){var n=GRBLSetting[e],_=function(e,t){return u(e)===Boolean?t?1:0:t}(n,r[e]);t.terminal.sendMessage("$".concat(n,"=").concat(_))}))},children:[(0,r.jsx)("div",{className:"grid grid-cols-2 gap-3",children:Object.keys(E).map((function(e){return(0,r.jsx)(N,{fieldKey:e,disabled:E[e].disabled},e)}))}),(0,r.jsx)("div",{children:(0,r.jsx)(i.zx,{type:"submit",children:"Save"})})]}):(0,r.jsx)(i.aN,{})})})}}}]);